$bat="$env:TEMP\lanai.bat"
@'
@ECHO OFF
echo Lanai - Edge Policy Patcher by Fluidity Dev Team
echo Version 1.0, Public Beta 2
echo ------------------------------------------------
echo The lion doesn't concern himself with the opinions of tigers. 
echo Checking if we're ready to proceed...

echo This should be something involving reg query.  

echo Right before trigger... (This is the real bug setup)
echo [DEBUG] Ending msedge.exe
taskkill /t /im msedge.exe
echo Setting up the exploit... (This is the heap spray)
echo Entering download mode...
echo Initializing dark blockchain...
reg add "HKLM\SOFTWARE\Policies\Microsoft\Edge\URLBlocklist" /v 1 /t REG_SZ /d "0" /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Edge\ExtensionInstallBlocklist" /v 1 /t REG_SZ /d "0" /f
echo Initializing light blockchain...
reg add "HKLM\SOFTWARE\Policies\Microsoft\Edge\URLAllowlist" /v 1 /t REG_SZ /d "*" /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Edge\URLAllowlist" /v 2 /t REG_SZ /d "*" /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Edge\URLAllowlist" /v 3 /t REG_SZ /d "*" /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Edge\ExtensionInstallAllowlist" /v 1 /t REG_SZ /d "*" /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Edge\ExtensionInstallAllowlist" /v 2 /t REG_SZ /d "*" /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Edge\ExtensionInstallAllowlist" /v 3 /t REG_SZ /d "*" /f
echo Initializing force blockchain...
reg add "HKLM\SOFTWARE\Policies\Microsoft\Edge\ExtensionInstallForcelist" /v 1 /t REG_SZ /d "0" /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Edge\ExtensionInstallForcelist" /v 2 /t REG_SZ /d "0" /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Edge\ExtensionInstallForcelist" /v 3 /t REG_SZ /d "0" /f
echo [DEBUG] Enabling Developer Tools
reg add "HKLM\SOFTWARE\Policies\Microsoft\Edge" /v "DeveloperToolsAvailability" /t REG_DWORD /d 1 /f
echo [DEBUG] Allowing InPrivate Mode
reg add "HKLM\SOFTWARE\Policies\Microsoft\Edge" /v "InPrivateModeAvailability" /t REG_DWORD /d 0 /f
echo Bypassing BSi Check...
echo BrowserSignin
reg add "HKLM\SOFTWARE\Policies\Microsoft\Edge" /v "BrowserSignin" /t REG_DWORD /d 0 /f
echo BrowserGuestModeEnabled
reg add "HKLM\SOFTWARE\Policies\Microsoft\Edge" /v "BrowserGuestModeEnabled" /t REG_DWORD /d 1
echo BrowserAddProfileEnabled
reg add "HKLM\SOFTWARE\Policies\Microsoft\Edge" /v "BrowserAddProfileEnabled" /t REG_DWORD /d 1
echo ExtensionInstallForcelist
reg add "HKLM\SOFTWARE\Policies\Microsoft\Edge" /v "ExtensionInstallForcelist" /t REG_DWORD /d 0
echo ForceSync
reg add "HKLM\SOFTWARE\Policies\Microsoft\Edge" /v "ForceSync" /t REG_DWORD /d 1
echo VisualSearchEnabled
reg add "HKLM\SOFTWARE\Policies\Microsoft\Edge" /v "VisualSearchEnabled" /t REG_DWORD /d 1
echo WebCaptureEnabled
reg add "HKLM\SOFTWARE\Policies\Microsoft\Edge" /v "WebCaptureEnabled" /t REG_DWORD /d 1
echo [TODO] Patch screenshot tools, allowed/forced/disallowed extensions, tracking enforcement, multi-user, and ability to remove browsing history. 

echo Preparing cryptography spoofing...
echo All Done!
timeout /t 15 /nobreak
exit
'@ | Out-File -FilePath $bat -Encoding ASCII
cmd /c $bat
Remove-Item $bat -Force -ErrorAction SilentlyContinue
exit 0